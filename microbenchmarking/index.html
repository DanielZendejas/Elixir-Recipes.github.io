
<hr />
<p>layout: post
title:  “Microbenchmarking”
keywords: “performance, benchmarking”
category: “performance”
comments: true
—</p>

<p>Use <a href="https://github.com/alco/benchfella"><code class="highlighter-rouge">benchfella</code></a> or <a href="https://github.com/PragTob/benchee"><code class="highlighter-rouge">benchee</code></a> to perform microbenchmarking of your Elixir code.</p>

<p>Using <code class="highlighter-rouge">benchfella</code>:</p>

<figure class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="k">defmodule</span> <span class="no">BasicBench</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">Benchfella</span>

  <span class="nv">@list</span> <span class="no">Enum</span><span class="o">.</span><span class="n">to_list</span><span class="p">(</span><span class="m">1</span><span class="o">..</span><span class="m">1000</span><span class="p">)</span>

  <span class="n">bench</span> <span class="sd">"</span><span class="s2">hello list"</span> <span class="k">do</span>
    <span class="no">Enum</span><span class="o">.</span><span class="n">reverse</span> <span class="nv">@list</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>Using <code class="highlighter-rouge">benchee</code>:</p>

<figure class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="n">list</span> <span class="o">=</span> <span class="no">Enum</span><span class="o">.</span><span class="n">to_list</span><span class="p">(</span><span class="m">1</span><span class="o">..</span><span class="m">10_000</span><span class="p">)</span>
<span class="n">map_fun</span> <span class="o">=</span> <span class="k">fn</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="k">end</span>

<span class="no">Benchee</span><span class="o">.</span><span class="n">run</span><span class="p">(%{</span><span class="ss">time:</span> <span class="m">3</span><span class="p">},</span> <span class="p">%{</span>
  <span class="sd">"</span><span class="s2">flat_map"</span>    <span class="o">=&gt;</span> <span class="k">fn</span> <span class="o">-&gt;</span> <span class="no">Enum</span><span class="o">.</span><span class="n">flat_map</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="n">map_fun</span><span class="p">)</span> <span class="k">end</span><span class="p">,</span>
  <span class="sd">"</span><span class="s2">map.flatten"</span> <span class="o">=&gt;</span> <span class="k">fn</span> <span class="o">-&gt;</span> <span class="n">list</span> <span class="o">|&gt;</span> <span class="no">Enum</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">map_fun</span><span class="p">)</span> <span class="o">|&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">flatten</span> <span class="k">end</span><span class="p">})</span></code></pre></figure>

